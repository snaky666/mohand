# دليل إعداد Supabase لموقع ⵎⵓⵃⵎⵎⴷ Barber

## الخطوات المطلوبة

### 1. إنشاء الجداول في Supabase

1. افتح لوحة تحكم Supabase الخاصة بك
2. اذهب إلى **SQL Editor**
3. انسخ والصق محتوى ملف `supabase-setup.sql` في المحرر
4. اضغط **Run** لتنفيذ الأوامر

### 2. التحقق من إنشاء الجداول

بعد تنفيذ الأوامر SQL، تأكد من إنشاء الجداول التالية:

- `bookings` - جدول الحجوزات
- `announcements` - جدول الإعلانات

### 3. التحقق من السياسات الأمنية (Row Level Security)

تأكد من أن السياسات الأمنية تم تفعيلها بشكل صحيح للسماح بالعمليات التالية:

#### جدول bookings:
- ✅ قراءة للجميع
- ✅ إضافة للجميع
- ✅ حذف للجميع

#### جدول announcements:
- ✅ قراءة للجميع
- ✅ إضافة/تعديل للجميع

### 4. اختبار الموقع

بعد إعداد قاعدة البيانات:

1. افتح الصفحة الرئيسية للموقع
2. جرب إنشاء حجز جديد
3. افتح لوحة الإدارة (كلمة المرور: `admin123`)
4. تحقق من ظهور الحجوزات
5. جرب إضافة إعلان
6. تحقق من ظهور الإعلان في الصفحة الرئيسية

## هيكل قاعدة البيانات

### جدول bookings
```
id          UUID (مفتاح أساسي)
name        TEXT (اسم العميل)
phone       TEXT (رقم الهاتف)
day         DATE (تاريخ الحجز)
created_at  TIMESTAMP (تاريخ الإنشاء)
updated_at  TIMESTAMP (تاريخ التحديث)
```

### جدول announcements
```
id          UUID (مفتاح أساسي)
message     TEXT (نص الإعلان)
created_at  TIMESTAMP (تاريخ الإنشاء)
updated_at  TIMESTAMP (تاريخ التحديث)
```

## ملاحظات مهمة

- تم تفعيل Row Level Security لحماية البيانات
- السياسات الحالية تسمح للجميع بالقراءة والكتابة
- يمكنك تعديل السياسات لاحقاً لإضافة مستوى أعلى من الأمان
- يتم حذف الحجوزات القديمة تلقائياً (أقدم من اليوم الحالي)

## استكشاف الأخطاء

### خطأ: "Could not find the table"
- تأكد من تنفيذ ملف `supabase-setup.sql` في SQL Editor
- تأكد من أن الجداول تم إنشاؤها في schema `public`

### خطأ في الاتصال
- تحقق من صحة SUPABASE_URL و SUPABASE_ANON_KEY في Secrets
- تأكد من أن المشروع في Supabase نشط وليس متوقفاً

### الحجوزات لا تظهر
- تحقق من تفعيل Row Level Security Policies
- تحقق من الأخطاء في Browser Console

## الدعم

إذا واجهت أي مشاكل، تحقق من:
1. سجلات المتصفح (Browser Console)
2. سجلات Supabase في لوحة التحكم
3. تأكد من صحة جميع الإعدادات
